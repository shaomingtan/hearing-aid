<script>
  function hasGetUserMedia() {
    return !!(navigator.mediaDevices &&
      navigator.mediaDevices.getUserMedia);
  }

  function streamAudio() {
    if (navigator.mediaDevices.getUserMedia) {
      navigator.mediaDevices.getUserMedia({audio: true}, function(stream) {
        const context = new (window.AudioContext || window.webkitAudioContext),
          result = {
            amplify: function(multiplier) { result.gain.gain.value = multiplier; },
          };
        const analyser = context.createAnalyser();
        const microphone = context.createMediaStreamSource(stream);
        microphone.connect(analyser);
        analyser.connect(context.destination);
      });
    };
  }

  if (hasGetUserMedia()) {
    console.log('Got media')
    streamAudio()
  } else {
    alert('getUserMedia() is not supported by your browser');
  }
</script>
